{% extends "layouts/main_cy-en.html" %}

{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

{% block content %}

{{ govukBackLink({
    text: data.translations.globalBackLink[data.lang],
    href: 'javascript:history.back()'
  }) }}


<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

        {% import 'tests/data-patients.html' as patientData %}
        {% set patient = patientData.data | getPatientDataByID( data.id ) %}

        {% if patient %}

        <!--


 ______   ________  _________     _       _____  _____      ______   
|_   _ `.|_   __  ||  _   _  |   / \     |_   _||_   _|   .' ____ \  
  | | `. \ | |_ \_||_/ | | \_|  / _ \      | |    | |     | (___ \_| 
  | |  | | |  _| _     | |     / ___ \     | |    | |   _  _.____`.  
 _| |_.' /_| |__/ |   _| |_  _/ /   \ \_  _| |_  _| |__/ || \____) | 
|______.'|________|  |_____||____| |____||_____||________| \______.' 
                                                                     


        -->

        <main class="govuk-main-wrapper">
            
            {{ patient.status | getStatusTag | safe }}
            <h1 class="govuk-heading-l govuk-!-margin-top-3 govuk-!-margin-bottom-2">{{ data.translations.mccdTasklistPageTitle[data.lang] }}</h1>
            <p class="govuk-body govuk-!-margin-bottom-6">Reference number: {{ patient.id }}</p>

            {% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

            <!-- DECEASED PERSONS DETAILS -->
            {{ govukSummaryList({
                card: {
                    title: { text: data.translations.pmMCCDTasklistDeceasedPersonsDetails[data.lang] }
                },
                rows: [
                    {  key: { text: data.translations.dpdCheckAnswersNHSNumber[data.lang] }, value: { text: patient.nhsNo } },
                    {  key: { text: data.translations.dpdCheckAnswersFullName[data.lang] }, value: { text: patient.name } },
                    {  key: { text: data.translations.dpdCheckAnswersDoB[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.dpdCheckAnswersAgeAtDeath[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.dpdCheckAnswersEthnicity[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.dpdCheckAnswersDoD[data.lang] }, value: { text: patient.dateOfDeath } },
                    {  key: { text: data.translations.dpdCheckAnswersDeathLocation[data.lang] }, value: { text: patient.placeOfDeath } },
                    {  key: { text: data.translations.dpdCheckAnswersConsultantName[data.lang] }, value: { text: '' } }
                ]
            }) }}

            <!-- ACTIONS AFTER DEATH -->
            {{ govukSummaryList({
                card: {
                    title: { text: data.translations.pmMCCDTasklistActionsAfterDeath[data.lang] }
                },
                rows: [
                    {  key: { text: data.translations.aadCheckAnswersPostMortem[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.aadCheckAnswersImplantsInBody[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.aadCheckAnswersImplantDetails[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.aadCheckAnswersImplantsRemoved[data.lang] }, value: { text: '' } }
                ]
            }) }}

            <!-- CAUSE OF DEATH  -->
            {{ govukSummaryList({
                card: {
                    title: { text: data.translations.pmMCCDTasklistCoD[data.lang] }
                },
                rows: [
                    {  key: { text: data.translations.CYAcodO281aMainDisease[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO281bDiseaseLeadingTo1a[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO281cDiseaseLeadingTo1b[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO281dDiseaseLeadingTo1c[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO282OtherConditions[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO28Employment[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO28Pregnancy[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.CYAcodO28PregnancyContributed[data.lang] }, value: { text: '' } }
                ]
            }) }}

            <!-- ATTENDING PRACTITIONERS INFORMATION -->
            {{ govukSummaryList({
                card: {
                    title: { text: data.translations.pmMCCDTasklistAttendingPractitionersInformation[data.lang] }
                },
                rows: [
                    {  key: { text: data.translations.dpdConfirmDetailsFullName[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.dpdConfirmDetailsGMC[data.lang] }, value: { text: '' } },
                    {  key: { text: data.translations.dpdConfirmDetailsWorkAddress[data.lang] }, value: { html: '' } }
                ]
            }) }}

            <!--


      _        ______  _________  _____   ___   ____  _____   ______   
     / \     .' ___  ||  _   _  ||_   _|.'   `.|_   \|_   _|.' ____ \  
    / _ \   / .'   \_||_/ | | \_|  | | /  .-.  \ |   \ | |  | (___ \_| 
   / ___ \  | |           | |      | | | |   | | | |\ \| |   _.____`.  
 _/ /   \ \_\ `.___.'\   _| |_    _| |_\  `-'  /_| |_\   |_ | \____) | 
|____| |____|`.____ .'  |_____|  |_____|`.___.'|_____|\____| \______.' 
                                                                       


            -->

            {% if data['role-type'] == 'ap' %}

            <button class="govuk-button govuk-button--secondary" type="submit">Back to dashboard</button>

            {% elseif data['role-type'] == 'me' %}
            <!-- IF STATUS = For sign off by Medical Examiner -->
            <form action="me-signoff" method="post">

                <div class="govuk-form-group">
            
                    <fieldset class="govuk-fieldset" aria-describedby="contact-hint">
            
                        <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            
                            <h2 class="govuk-fieldset__heading govuk-!-margin-top-5 govuk-!-margin-bottom-3">
                                Medical examiner sign off
                            </h2>
            
                        </legend>
            
                        <div class="govuk-radios" data-module="govuk-radios">
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input" id="me-signoff-amend" name="me-signoff" type="radio"
                                    value="This certificate requires amendments by the attending practitioner">
                                <label class="govuk-label govuk-radios__label" for="me-signoff-amend">
                                    This certificate requires amendments by the attending practitioner
                                </label>
                            </div>
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input" id="me-signoff-registrar" name="me-signoff" type="radio"
                                    value="This certificate is ready to be sent to the registrar">
                                <label class="govuk-label govuk-radios__label" for="me-signoff-registrar">
                                    This certificate is ready to be sent to the registrar
                                </label>
                            </div>
            
                        </div>
            
                    </fieldset>
                </div>
            
                <button class="govuk-button govuk-button--primary" type="submit">Save and continue</button>
                <button class="govuk-button govuk-button--secondary" type="submit">Back to dashboard</button>
                
            </form>


            <!--IF ANY OTHER STATUS -->
            <button class="govuk-button govuk-button--secondary" type="submit">Back to dashboard</button>

            {% else %}

            <!-- IF STATUS = For officer review OR Amended-->
            <form action="officer-review" method="post">

                <div class="govuk-form-group">
            
                    <fieldset class="govuk-fieldset" aria-describedby="contact-hint">
            
                        <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            
                            <h2 class="govuk-fieldset__heading govuk-!-margin-top-5 govuk-!-margin-bottom-3">
                                Medical examiner officer review
                            </h2>
            
                        </legend>
            
                        <div class="govuk-radios" data-module="govuk-radios">
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input" id="officer-review-amend" name="officer-review" type="radio"
                                    value="1">
                                <label class="govuk-label govuk-radios__label" for="officer-review-amend">
                                    This certificate requires amendments by the attending practitioner
                                </label>
                            </div>
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input" id="officer-review-signoff" name="officer-review" type="radio"
                                    value="2">
                                <label class="govuk-label govuk-radios__label" for="officer-review-signoff">
                                    This certificate is ready for medical examiner sign off
                                </label>
                            </div>
            
                        </div>
            
                    </fieldset>
                </div>
            
                <button class="govuk-button govuk-button--primary" type="submit">Save and continue</button>
                <button class="govuk-button govuk-button--secondary" type="submit">Back to dashboard</button>
            
            </form>

            <!--IF STATUS = Review complete - send to registrar-->
            <form action="download-share" method="post">

                <div class="govuk-form-group">
            
                    <fieldset class="govuk-fieldset" aria-describedby="contact-hint">
            
                        <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            
                            <h2 class="govuk-fieldset__heading govuk-!-margin-top-5 govuk-!-margin-bottom-3">
                                Download certificate
                            </h2>
                            <p>Download this certificate to your computer and send it to the registrar via email. Once you are ready, come back to this screen to mark this certificate as sent by ticking the checkbox below.</p>
                            <button class="govuk-button govuk-button--primary" type="submit">Download certificate</button>
            
                        </legend>
            
                        <div class="govuk-checkboxes" data-module="govuk-checkboxes">
                            <div class="govuk-checkboxes__item">
                                <input class="govuk-checkboxes__input" id="sent-to-registrar" name="sent-to-registrar" type="checkbox" value="I have sent this certificate to the registrar">
                                <label class="govuk-label govuk-checkboxes__label" for="sent-to-registrar">
                                    I have sent this certificate to the registrar
                                </label>
                            </div>
                        </div>
            
                    </fieldset>
                </div>
            
                <button class="govuk-button govuk-button--primary" type="submit">Mark MCCD as sent to registrar</button>
                <button class="govuk-button govuk-button--secondary" type="submit">Back to dashboard</button>
                
            </form>
            {% endif %}


        </main>

        {% else %}

            <h1 class="govuk-heading-l">Patient not found</h1>

            {{ govukInsetText({
                text: 'No patient information could be found for that ID.'
            }) }}

        {% endif %}

    </div>
</div>

{{ data | debugData | safe }}

{% endblock %}