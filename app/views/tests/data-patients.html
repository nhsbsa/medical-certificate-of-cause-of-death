{% set data = [{"id":"0001","name":"Aaliyah Farah Abbas","nhsNo":"437 171 9091","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":2,"lastNameFirst":"Abbas, Aaliyah Farah"},{"id":"0002","name":"Adrian Dickson","nhsNo":"476 815 5144","placeOfDeath":"Community<br>ME cert","dateOfDeath":"29 March 2023","status":3,"lastNameFirst":"Dickson, Adrian"},{"id":"0003","name":"Amelia Brown","nhsNo":"395 604 9611","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":0,"lastNameFirst":"Brown, Amelia"},{"id":"0004","name":"Andrea Bartlett","nhsNo":"171 078 5258","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":5,"lastNameFirst":"Bartlett, Andrea"},{"id":"0005","name":"Andrea Bishop","nhsNo":"218 373 9692","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":4,"lastNameFirst":"Bishop, Andrea"},{"id":"0006","name":"Angel Hewitt","nhsNo":"975 343 6422","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":4,"lastNameFirst":"Hewitt, Angel"},{"id":"0007","name":"Armaan Chang","nhsNo":"583 546 0381","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":0,"lastNameFirst":"Chang, Armaan"},{"id":"0008","name":"Brogan Hali Bowers","nhsNo":"570 479 4199","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":4,"lastNameFirst":"Bowers, Brogan Hali"},{"id":"0009","name":"Caleb Greenaway","nhsNo":"348 890 3827","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":0,"lastNameFirst":"Greenaway, Caleb"},{"id":"0010","name":"Charley Angeli Frost","nhsNo":"952 792 6321","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":3,"lastNameFirst":"Frost, Charley Angeli"},{"id":"0011","name":"Charlie Endo Tran","nhsNo":"789 045 129","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":2,"lastNameFirst":"Tran, Charlie Endo"},{"id":"0012","name":"Cian Yates","nhsNo":"324 867 6274","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":1,"lastNameFirst":"Yates, Cian"},{"id":"0013","name":"Darcey Rowe","nhsNo":"811 158 6078","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":5,"lastNameFirst":"Rowe, Darcey"},{"id":"0014","name":"Devon Barlow","nhsNo":"832 908 8168","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":5,"lastNameFirst":"Barlow, Devon"},{"id":"0015","name":"Dillan Jhorrad Khan","nhsNo":"491 026 7589","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":0,"lastNameFirst":"Khan, Dillan Jhorrad"},{"id":"0016","name":"Dillon Norman","nhsNo":"329 239 4305","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":2,"lastNameFirst":"Norman, Dillon"},{"id":"0017","name":"Ebony Austin","nhsNo":"610 313 8051","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":1,"lastNameFirst":"Austin, Ebony"},{"id":"0018","name":"Elena Domenica Hunt","nhsNo":"669 547 4853","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":4,"lastNameFirst":"Hunt, Elena Domenica"},{"id":"0019","name":"Erik Hendin","nhsNo":"512 190 3953","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":4,"lastNameFirst":"Hendin, Erik"},{"id":"0020","name":"Erin Potts","nhsNo":"931 570 707","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":1,"lastNameFirst":"Potts, Erin"},{"id":"0021","name":"Faith Wiggins","nhsNo":"141 939 2129","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":5,"lastNameFirst":"Wiggins, Faith"},{"id":"0022","name":"Felix Ashley Ware","nhsNo":"597 549 0229","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":3,"lastNameFirst":"Ware, Felix Ashley"},{"id":"0023","name":"Harris Bowman","nhsNo":"810 115 4635","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":5,"lastNameFirst":"Bowman, Harris"},{"id":"0024","name":"Idris Felba","nhsNo":"845 872 7060","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":3,"lastNameFirst":"Felba, Idris"},{"id":"0025","name":"Jenna Kirk","nhsNo":"533 009 3294","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":4,"lastNameFirst":"Kirk, Jenna"},{"id":"0026","name":"Jerry Sherman","nhsNo":"268 484 1309","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":2,"lastNameFirst":"Sherman, Jerry"},{"id":"0027","name":"Jordan Carrillo","nhsNo":"687 235 9975","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":4,"lastNameFirst":"Carrillo, Jordan"},{"id":"0028","name":"Joseph William Doyle","nhsNo":"736 007 4551","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":2,"lastNameFirst":"Doyle, Joseph William"},{"id":"0029","name":"Jude Perry","nhsNo":"714 927 621","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":4,"lastNameFirst":"Perry, Jude"},{"id":"0030","name":"Julia Graham","nhsNo":"445 862 2503","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":4,"lastNameFirst":"Graham, Julia"},{"id":"0031","name":"Kaya Hoffman","nhsNo":"282 869 3646","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":2,"lastNameFirst":"Hoffman, Kaya"},{"id":"0032","name":"Kia Ravi","nhsNo":"884 301 8446","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":1,"lastNameFirst":"Ravi, Kia"},{"id":"0033","name":"Kristen Chandler","nhsNo":"531 196 7319","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":0,"lastNameFirst":"Chandler, Kristen"},{"id":"0034","name":"Kyan Mcguire","nhsNo":"387 626 3522","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":2,"lastNameFirst":"Mcguire, Kyan"},{"id":"0035","name":"Lachlan Rosario","nhsNo":"451 050 6387","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":1,"lastNameFirst":"Rosario, Lachlan"},{"id":"0036","name":"Laurie Boyd","nhsNo":"511 061 5670","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":4,"lastNameFirst":"Boyd, Laurie"},{"id":"0037","name":"Lea Donna Durham","nhsNo":"285 051 6931","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":3,"lastNameFirst":"Durham, Lea Donna"},{"id":"0038","name":"Louie O'Quinn","nhsNo":"818 834 3298","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":3,"lastNameFirst":"O'Quinn, Louie"},{"id":"0039","name":"Mackenzie Howard","nhsNo":"145 025 1699","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":0,"lastNameFirst":"Howard, Mackenzie"},{"id":"0040","name":"Maddison Juarez","nhsNo":"455 035 3397","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":3,"lastNameFirst":"Juarez, Maddison"},{"id":"0041","name":"Mae Alexander","nhsNo":"313 923 5092","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":2,"lastNameFirst":"Alexander, Mae"},{"id":"0042","name":"Malik Sloan","nhsNo":"624 363 3996","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":1,"lastNameFirst":"Sloan, Malik"},{"id":"0043","name":"Marissa Guerrero","nhsNo":"133 432 0436","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":0,"lastNameFirst":"Guerrero, Marissa"},{"id":"0044","name":"Marley Myers","nhsNo":"118 552 155","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":4,"lastNameFirst":"Myers, Marley"},{"id":"0045","name":"Mika Low","nhsNo":"948 027 0149","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":3,"lastNameFirst":"Low, Mika"},{"id":"0046","name":"Milo Brett","nhsNo":"967 856 3616","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":4,"lastNameFirst":"Brett, Milo"},{"id":"0047","name":"Mina Wu","nhsNo":"830 107 5456","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":2,"lastNameFirst":"Wu, Mina"},{"id":"0048","name":"Minato Semaj","nhsNo":"759 278 0396","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":5,"lastNameFirst":"Semaj, Minato"},{"id":"0049","name":"Molly Knowles","nhsNo":"265 739 4257","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":3,"lastNameFirst":"Knowles, Molly"},{"id":"0050","name":"Myra Jari Adkins","nhsNo":"293 527 5628","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":3,"lastNameFirst":"Adkins, Myra Jari"},{"id":"0051","name":"Nana Bullock","nhsNo":"253 549 6903","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":3,"lastNameFirst":"Bullock, Nana"},{"id":"0052","name":"Pearl Small","nhsNo":"664 344 7404","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":5,"lastNameFirst":"Small, Pearl"},{"id":"0053","name":"Riley James","nhsNo":"860 681 951","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":0,"lastNameFirst":"James, Riley"},{"id":"0054","name":"Rory Vaughn","nhsNo":"514 515 6804","placeOfDeath":"Community","dateOfDeath":"29 March 2023","status":2,"lastNameFirst":"Vaughn, Rory"},{"id":"0055","name":"Sasha Castro","nhsNo":"159 268 7919","placeOfDeath":"Community","dateOfDeath":"27 March 2023","status":3,"lastNameFirst":"Castro, Sasha"},{"id":"0056","name":"Shannon Ferrell","nhsNo":"986 825 3334","placeOfDeath":"Community","dateOfDeath":"28 March 2023","status":3,"lastNameFirst":"Ferrell, Shannon"},{"id":"0057","name":"Sienna Mcdonald","nhsNo":"324 606 4930","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":0,"lastNameFirst":"Mcdonald, Sienna"},{"id":"0058","name":"Taylor Marshall","nhsNo":"799 366 2629","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":1,"lastNameFirst":"Marshall, Taylor"},{"id":"0059","name":"Verity Duncann","nhsNo":"762 770 3043","placeOfDeath":"Community","dateOfDeath":"26 March 2023","status":3,"lastNameFirst":"Duncann, Verity"}] %}
{% extends "layouts/main.html" %}

{% block pageTitle %}
Patient data
{% endblock %}

{% block content %}

<div class="govuk-grid-row">

  <div class="govuk-grid-column-two-thirds govuk-!-margin-top-8">

    <div class="govuk-form-group">
      <h1 class="govuk-label-wrapper">
        <label class="govuk-label govuk-label--l" for="patient-data">
          Patient data
        </label>
      </h1>
      <div id="patient-data-hint" class="govuk-hint">
        Information stored in the variable "data", passed to the page <a href="nunjucks-dashboard">nunjucks dashboard</a>.
      </div>
      <textarea class="govuk-textarea" id="patient-data" name="moreDetail" rows="5" aria-describedby="patient-data-hint">{{ data | dump }}</textarea>
    </div>

  </div>

</div>


<script>



  document.addEventListener('DOMContentLoaded', function () {

    const statuses = ['For officer review','To be amended','Amended','For sign off by medical examiner','Review complete - send to registrar','Sent to registrar'];

    const textArea = document.querySelector('#patient-data');
    const json = JSON.parse(textArea.innerHTML);

    const _generateNHSNumber = function () {

      let randomNumber = Math.floor(Math.random() * 10000000000);
      let numberString = randomNumber.toString();
      numberString = numberString.slice(0, 3) + ' ' + numberString.slice(3, 6) + ' ' + numberString.slice(6);

      return numberString;
    }

    // Update the data
    json.forEach(function (row) {

      const currentDates = ['29 March 2023', '28 March 2023', '27 March 2023', '26 March 2023'];

      row.nhsNo = _generateNHSNumber();
      row.status = Math.round(Math.random()*5); // Should generate a random number between 0-5
      row.dateOfDeath = currentDates[Math.round(Math.random()*(currentDates.length-1))];

      let nameArr = ( row.name ) ? row.name.split(' ') : ['First','Last'];
      nameArr.unshift(nameArr.pop());

      row.lastNameFirst = nameArr[0];
      nameArr.shift();

      row.lastNameFirst += ', ' + nameArr.join(' ');

      delete row.statuses;
      delete row.actions;

    });

    textArea.innerHTML = JSON.stringify(json);

  });
</script>


{% endblock %}