{% set data = [{"id":"83503831-24","name":"Aaliyah Farah Abbas","nhsNo":"805 422 3165","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":0,"lastNameFirst":"Abbas, Aaliyah Farah","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"95 years old"},{"id":"5146290-24","name":"Adrian Dickson","nhsNo":"346 626 9701","placeOfDeath":"Community<br>ME cert","dateOfDeath":"29 April 2024","status":3,"lastNameFirst":"Dickson, Adrian","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"87 years old"},{"id":"85353412-24","name":"Amelia Brown","nhsNo":"136 547 435","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":1,"lastNameFirst":"Brown, Amelia","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"11 years old"},{"id":"62880560-24","name":"Andrea Bartlett","nhsNo":"513 223 314","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":1,"lastNameFirst":"Bartlett, Andrea","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"69 years old"},{"id":"83268263-24","name":"Andrea Bishop","nhsNo":"848 967 3363","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":2,"lastNameFirst":"Bishop, Andrea","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"38 years old"},{"id":"656047119-24","name":"Angel Hewitt","nhsNo":"257 173 5715","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":3,"lastNameFirst":"Hewitt, Angel","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"58 years old"},{"id":"395632604-24","name":"Armaan Chang","nhsNo":"948 891 0502","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":5,"lastNameFirst":"Chang, Armaan","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"50 years old"},{"id":"97838668-24","name":"Brogan Hali Bowers","nhsNo":"870 489 8632","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":4,"lastNameFirst":"Bowers, Brogan Hali","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"49 years old"},{"id":"3856845-24","name":"Caleb Greenaway","nhsNo":"300 480 0732","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":4,"lastNameFirst":"Greenaway, Caleb","belongsToAP":true,"belongsToME":false,"under28days":true,"age":"27 days old"},{"id":"81868654-24","name":"Charley Angeli Frost","nhsNo":"717 293 9356","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":4,"lastNameFirst":"Frost, Charley Angeli","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"23 years old"},{"id":"5471364-24","name":"Charlie Endo Tran","nhsNo":"171 924 8583","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":1,"lastNameFirst":"Tran, Charlie Endo","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"67 years old"},{"id":"152351066-24","name":"Cian Yates","nhsNo":"506 934 1527","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":3,"lastNameFirst":"Yates, Cian","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"21 years old"},{"id":"9838409-24","name":"Darcey Rowe","nhsNo":"585 732 2174","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":0,"lastNameFirst":"Rowe, Darcey","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"85 years old"},{"id":"6694480-24","name":"Devon Barlow","nhsNo":"234 024 7268","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":5,"lastNameFirst":"Barlow, Devon","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"77 years old"},{"id":"8756557-24","name":"Dillan Jhorrad Khan","nhsNo":"818 478 2107","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":4,"lastNameFirst":"Khan, Dillan Jhorrad","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"22 years old"},{"id":"941686853-24","name":"Dillon Norman","nhsNo":"409 356 8605","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":1,"lastNameFirst":"Norman, Dillon","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"44 years old"},{"id":"1708007-24","name":"Ebony Austin","nhsNo":"213 754 8873","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":1,"lastNameFirst":"Austin, Ebony","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"80 years old"},{"id":"9422108-24","name":"Elena Domenica Hunt","nhsNo":"618 164 9302","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":0,"lastNameFirst":"Hunt, Elena Domenica","belongsToAP":false,"belongsToME":true,"under28days":true,"age":"1 days old"},{"id":"6155976-24","name":"Erik Hendin","nhsNo":"118 192 6597","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":5,"lastNameFirst":"Hendin, Erik","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"52 years old"},{"id":"335604928-24","name":"Erin Potts","nhsNo":"915 066 9597","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":1,"lastNameFirst":"Potts, Erin","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"49 years old"},{"id":"666049555-24","name":"Faith Wiggins","nhsNo":"750 606 7482","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":2,"lastNameFirst":"Wiggins, Faith","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"98 years old"},{"id":"370576916-24","name":"Felix Ashley Ware","nhsNo":"504 165 6644","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":5,"lastNameFirst":"Ware, Felix Ashley","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"54 years old"},{"id":"4567188-24","name":"Harris Bowman","nhsNo":"603 637 6027","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":1,"lastNameFirst":"Bowman, Harris","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"93 years old"},{"id":"18670211-24","name":"Idris Felba","nhsNo":"545 520 9332","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":5,"lastNameFirst":"Felba, Idris","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"18 years old"},{"id":"230797388-24","name":"Jenna Kirk","nhsNo":"516 234 2411","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":3,"lastNameFirst":"Kirk, Jenna","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"5 years old"},{"id":"65230015-24","name":"Jerry Sherman","nhsNo":"470 467 8096","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":1,"lastNameFirst":"Sherman, Jerry","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"33 years old"},{"id":"2240325-24","name":"Jordan Carrillo","nhsNo":"694 123 4327","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":3,"lastNameFirst":"Carrillo, Jordan","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"67 years old"},{"id":"3787873-24","name":"Joseph William Doyle","nhsNo":"607 193 5550","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":2,"lastNameFirst":"Doyle, Joseph William","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"92 years old"},{"id":"61377648-24","name":"Jude Perry","nhsNo":"363 077 8677","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":4,"lastNameFirst":"Perry, Jude","belongsToAP":true,"belongsToME":false,"under28days":true,"age":"18 days old"},{"id":"473430344-24","name":"Julia Graham","nhsNo":"741 971 2239","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":2,"lastNameFirst":"Graham, Julia","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"20 years old"},{"id":"49773136-24","name":"Kaya Hoffman","nhsNo":"848 303 1213","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":4,"lastNameFirst":"Hoffman, Kaya","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"62 years old"},{"id":"4753557-24","name":"Kia Ravi","nhsNo":"583 143 720","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":3,"lastNameFirst":"Ravi, Kia","belongsToAP":true,"belongsToME":false,"under28days":true,"age":"7 days old"},{"id":"2682511-24","name":"Kristen Chandler","nhsNo":"412 278 9333","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":5,"lastNameFirst":"Chandler, Kristen","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"21 years old"},{"id":"84045346-24","name":"Kyan Mcguire","nhsNo":"514 192 2146","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":4,"lastNameFirst":"Mcguire, Kyan","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"8 years old"},{"id":"2557750-24","name":"Lachlan Rosario","nhsNo":"252 544 5463","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":4,"lastNameFirst":"Rosario, Lachlan","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"84 years old"},{"id":"3195281-24","name":"Laurie Boyd","nhsNo":"266 874 2740","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":5,"lastNameFirst":"Boyd, Laurie","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"81 years old"},{"id":"26002261-24","name":"Lea Donna Durham","nhsNo":"796 644 9894","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":2,"lastNameFirst":"Durham, Lea Donna","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"5 years old"},{"id":"1253471-24","name":"Louie O'Quinn","nhsNo":"290 659 4228","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":4,"lastNameFirst":"O'Quinn, Louie","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"73 years old"},{"id":"901977060-24","name":"Mackenzie Howard","nhsNo":"723 533 4049","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":3,"lastNameFirst":"Howard, Mackenzie","belongsToAP":true,"belongsToME":false,"under28days":true,"age":"12 days old"},{"id":"8774916-24","name":"Maddison Juarez","nhsNo":"400 629 1251","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":2,"lastNameFirst":"Juarez, Maddison","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"56 years old"},{"id":"943800263-24","name":"Mae Alexander","nhsNo":"779 223 6877","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":0,"lastNameFirst":"Alexander, Mae","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"59 years old"},{"id":"47611228-24","name":"Malik Sloan","nhsNo":"773 932 3841","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":4,"lastNameFirst":"Sloan, Malik","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"34 years old"},{"id":"187327403-24","name":"Marissa Guerrero","nhsNo":"439 316 1505","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":4,"lastNameFirst":"Guerrero, Marissa","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"89 years old"},{"id":"60495159-24","name":"Marley Myers","nhsNo":"106 390 1355","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":2,"lastNameFirst":"Myers, Marley","belongsToAP":false,"belongsToME":false,"under28days":true,"age":"17 days old"},{"id":"7328852-24","name":"Mika Low","nhsNo":"391 535 3564","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":1,"lastNameFirst":"Low, Mika","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"25 years old"},{"id":"76477275-24","name":"Milo Brett","nhsNo":"230 239 9727","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":1,"lastNameFirst":"Brett, Milo","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"91 years old"},{"id":"2149272-24","name":"Mina Wu","nhsNo":"391 272 3462","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":1,"lastNameFirst":"Wu, Mina","belongsToAP":false,"belongsToME":false,"under28days":true,"age":"10 days old"},{"id":"558292514-24","name":"Minato Semaj","nhsNo":"430 730 5269","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":4,"lastNameFirst":"Semaj, Minato","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"47 years old"},{"id":"253443146-24","name":"Molly Knowles","nhsNo":"879 895 2845","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":2,"lastNameFirst":"Knowles, Molly","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"76 years old"},{"id":"7550639-24","name":"Myra Jari Adkins","nhsNo":"914 178 671","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":3,"lastNameFirst":"Adkins, Myra Jari","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"73 years old"},{"id":"596695577-24","name":"Nana Bullock","nhsNo":"664 655 7118","placeOfDeath":"Community","dateOfDeath":"26 April 2024","status":0,"lastNameFirst":"Bullock, Nana","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"84 years old"},{"id":"22754410-24","name":"Pearl Small","nhsNo":"959 389 700","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":2,"lastNameFirst":"Small, Pearl","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"95 years old"},{"id":"972490907-24","name":"Riley James","nhsNo":"579 353 8562","placeOfDeath":"Community","dateOfDeath":"28 April 2024","status":3,"lastNameFirst":"James, Riley","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"41 years old"},{"id":"693725276-24","name":"Rory Vaughn","nhsNo":"264 940 7202","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":1,"lastNameFirst":"Vaughn, Rory","belongsToAP":false,"belongsToME":false,"under28days":true,"age":"15 days old"},{"id":"242645979-24","name":"Sasha Castro","nhsNo":"888 066 2089","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":5,"lastNameFirst":"Castro, Sasha","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"44 years old"},{"id":"198346129-24","name":"Shannon Ferrell","nhsNo":"580 918 6613","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":3,"lastNameFirst":"Ferrell, Shannon","belongsToAP":false,"belongsToME":true,"under28days":false,"age":"51 years old"},{"id":"13322904-24","name":"Sienna Mcdonald","nhsNo":"700 486 9010","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":2,"lastNameFirst":"Mcdonald, Sienna","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"52 years old"},{"id":"8270067-24","name":"Taylor Marshall","nhsNo":"148 847 0566","placeOfDeath":"Community","dateOfDeath":"27 April 2024","status":3,"lastNameFirst":"Marshall, Taylor","belongsToAP":false,"belongsToME":false,"under28days":false,"age":"53 years old"},{"id":"82039367-24","name":"Verity Duncann","nhsNo":"924 043 2404","placeOfDeath":"Community","dateOfDeath":"29 April 2024","status":5,"lastNameFirst":"Duncann, Verity","belongsToAP":true,"belongsToME":false,"under28days":false,"age":"84 years old"}] %}
{% extends "layouts/main.html" %}

{% block pageTitle %}
Patient data
{% endblock %}

{% block content %}

<div class="govuk-grid-row">

  <div class="govuk-grid-column-two-thirds govuk-!-margin-top-8">

    <div class="govuk-form-group">
      <h1 class="govuk-label-wrapper">
        <label class="govuk-label govuk-label--l" for="patient-data">
          Patient data
        </label>
      </h1>
      <div id="patient-data-hint" class="govuk-hint">
        Information stored in the variable "data", passed to the <a href="dashboard">dashboard</a> page.
      </div>
      <textarea class="govuk-textarea" id="patient-data" name="moreDetail" rows="5" aria-describedby="patient-data-hint">{{ data | dump }}</textarea>
    </div>

  </div>

</div>


<script>



  document.addEventListener('DOMContentLoaded', function () {

    //
    // PLEASE NOTE:
    // This code take the data from above and modifies it, outputting the result into
    // the textarea shown when you view the page. It is used to tweak stuff (like the dates) 
    // for testing
    //
    // If you want to update the data, you can copy/pase from the textarea into the first line above 
    //

    const textArea = document.querySelector('#patient-data');
    const json = JSON.parse(textArea.innerHTML);

    const _generateNHSNumber = function () {

      const randomNumber = Math.floor(Math.random() * 10000000000);
      let numberString = randomNumber.toString();
      numberString = numberString.slice(0, 3) + ' ' + numberString.slice(3, 6) + ' ' + numberString.slice(6);

      return numberString;
    }

    function _generateReferenceNumber() {
  
        const length = Math.floor(Math.random() * 3) + 7;
        const base = Math.pow(10, length - 1);
        const max = Math.pow(10, length) - 1;
        const ref = Math.floor(Math.random() * (max - base + 1)) + base + '-24';
        
      return ref;
  }

    // Update the data
    /*
    json.forEach(function (row) {

      const currentDates = ['26 April 2024', '27 April 2024', '28 April 2024', '29 April 2024'];

      // Feel free to uncomment these if you want to regenerate stuff, like dates, statuses etc...

      //row.nhsNo = _generateNHSNumber();
      //row.status = Math.round(Math.random()*5); // Should generate a random number between 0-5
      row.under28days = ( Math.round(Math.random()*5) === 0 ) ? true : false;
      if( row.under28days ){
        // Neo-Natal
        row.age = (Math.round(Math.random()*27)+1) + ' days old';
      } else {
        row.age = (Math.round(Math.random()*100)+1) + ' years old';
      }

      row.dateOfDeath = currentDates[Math.round(Math.random()*(currentDates.length-1))];
      row.id = _generateReferenceNumber();

      let nameArr = ( row.name ) ? row.name.split(' ') : ['First','Last'];
      nameArr.unshift(nameArr.pop());

      row.lastNameFirst = nameArr[0];
      nameArr.shift();

      row.lastNameFirst += ', ' + nameArr.join(' ');

      //row.belongsToAP = ( Math.round(Math.random()*3) === 0 ) ? true : false;
      //row.belongsToME = ( row.belongsToAP === false && Math.round(Math.random()*2) === 0 ) ? true : false;

      delete row.statuses;
      delete row.actions;

    });

    textArea.innerHTML = JSON.stringify(json);
    */
    

  });
</script>


{% endblock %}